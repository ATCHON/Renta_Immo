# Story 2.6.4: Amélioration Formulaire Régimes

Status: ready-for-dev

## Story

**As a** nouvel utilisateur,
**I want** être guidé pas à pas dans le choix de mon régime fiscal,
**so that** je ne sois pas perdu face à la complexité des options (LMNP, Micro, Réel, SCI).

## Acceptance Criteria

1. [ ] **Parcours guidé** : Refonte de l'étape "Structure/Fiscalité" pour poser des questions simples (ex: "Louez-vous en meublé ou en nu ?").
2. [ ] **Filtrage intelligent** : N'afficher que les régimes compatibles avec le choix précédent.
3. [ ] **Aide contextuelle** : Tooltips ou micro-explications pour chaque abréviation (LMNP, BIC, etc.).
4. [ ] **Appel au comparateur** : Ajouter un bouton "Comparer les régimes" qui ouvre le comparateur fiscal (S5.3).
5. [ ] **Validation Zod** : S'assurer que les conditions de visibilité sont cohérentes avec les schémas de validation.

## Tasks / Subtasks

- [ ] **Task 1: Refonte de l'étape Structure** (AC: 1, 2)
  - [ ] Modifier `src/components/forms/StepStructure.tsx` pour utiliser une logique de type "Questionnaire".
  - [ ] Utiliser des "Card Selectors" (plus visuels) plutôt que des simples Dropdowns.
- [ ] **Task 2: Intégration Pédagogique** (AC: 3, 4)
  - [ ] Ajouter des tooltips `InfoTooltip` sur chaque option.
  - [ ] Intégrer le lien/bouton vers le composant `FiscalComparator`.
- [ ] **Task 3: Cohérence des données** (AC: 5)
  - [ ] Vérifier que `calculateur.store.ts` et `validators.ts` gèrent bien les dépendances entre champs (ex: cacher le TMI si SCI IS est sélectionné, car non pertinent).

## Dev Notes

### Architecture Patterns
- **Forms** : React Hook Form avec `watch` pour les changements d'état conditionnels.
- **UI Components** : Utiliser des cartes sélectionnables avec états `active` stylisés avec Tailwind.

### Source Tree Components
- Forms : `src/components/forms/StepStructure.tsx`, `src/components/forms/StepFiscalite.tsx`.
- Schema : `src/lib/validators.ts`.

### Testing Standards
- UX : Vérifier qu'un utilisateur qui choisit "Nu" ne voit pas les options "Micro-BIC".
- Mobile : Tester la lisibilité des cartes d'options sur petit écran.

### References
- [PRD: Section 3 Objectifs UI/UX](file:///d:/Devs/Renta_Immo/docs/prd.md#L111)
- [Story S5.3: Comparateur Fiscal](file:///d:/Devs/Renta_Immo/_bmad-output/implementation-artifacts/2.5.3-comparateur-fiscal.md)

## Dev Agent Record

### Agent Model Used
Antigravity (Google Deepmind)

### Completion Notes List
- Conversion of static form to a guided wizard flow.
- Integration with the fiscal comparator for expert advice.
